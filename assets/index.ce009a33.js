var k=Object.defineProperty;var m=(n,e,s)=>e in n?k(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var i=(n,e,s)=>(m(n,typeof e!="symbol"?e+"":e,s),s);import{P as a}from"./vendor.3fc30302.js";const f=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(t){if(t.ep)return;t.ep=!0;const r=s(t);fetch(t.href,r)}};f();class b extends Phaser.Scene{constructor(){super({key:"skysene"});i(this,"spillernavn");i(this,"bredde");i(this,"hoyde");i(this,"forrigeResultat",0);i(this,"resultat",0);i(this,"toppresultat",0);i(this,"toppresultatServer",0);i(this,"skybilRoyk");i(this,"skybilRoykTeller",0);i(this,"skybilKonteiner");i(this,"ballonggruppe");i(this,"resultattekst");i(this,"startfart",200);i(this,"fartsokningPerBallong",5);i(this,"fart",this.startfart);i(this,"innstillinger",{tyngekraftSkybil:900,flykraft:400,avstandMellomballonger:200,maksHoydeAvstandMellomToballonger:100,antallballonger:8,nokkelLagring:"skyen-toppresultat",startX:150});i(this,"lydeffekter",{})}init(e){this.bredde=this.game.scale.gameSize.width,this.hoyde=this.game.scale.gameSize.height,this.innstillinger.antallballonger=Math.ceil(this.bredde/this.innstillinger.avstandMellomballonger),(this.hoyde/this.bredde>2||this.bredde<400)&&(this.innstillinger.startX=70),this.sound.volume=.25,e.spillernavn&&(this.spillernavn=e.spillernavn),e.toppresultatServer&&(this.toppresultatServer=e.toppresultatServer)}preload(){this.load.spritesheet("skybil","assets/skybil-sprite.png",{frameWidth:332,frameHeight:150}),this.load.image("ballong","assets/ballong.png"),this.load.audioSprite("lydeffekter","assets/lydeffekter.json");const e=localStorage.getItem(this.innstillinger.nokkelLagring);this.toppresultat=e===null?0:+e}create(){this.sound.addAudioSprite("lydeffekter"),this.lydeffekter.poeng=()=>{this.sound.playAudioSprite("lydeffekter","smb_coin",{volume:.3})},this.lydeffekter.motor=()=>{this.sound.playAudioSprite("lydeffekter","engine4-kort")},this.lydeffekter.tap=()=>{this.sound.playAudioSprite("lydeffekter","smb_bowserfalls")};const e=this.add.sprite(0,0,"skybil");this.skybilRoyk=this.add.sprite(0,0,"skybil",2),this.skybilRoyk.visible=!1,this.skybilKonteiner=this.add.container(this.innstillinger.startX,this.hoyde/2,[e,this.skybilRoyk]),this.anims.create({key:"styreanimasjon",frames:this.anims.generateFrameNumbers("skybil",{frames:[0,1]}),frameRate:5,repeat:-1}),e.anims.play("styreanimasjon"),this.skybilKonteiner.setScale(.6),this.physics.add.existing(this.skybilKonteiner),this.skybilKonteiner.body.setGravityY(this.innstillinger.tyngekraftSkybil).setSize(200,100).setOffset(-50,-30).setBounce(0,.3),this.input.on("pointerdown",()=>this.fly()),this.ballonggruppe=this.physics.add.group();let l=this.skybilKonteiner.x+100,t=this.hoyde/2;for(let r=0;r<this.innstillinger.antallballonger;r++){const[o,h]=this.lagGanskeTilfeldigXY(l,t);this.ballonggruppe.create(o,h,"ballong"),l=o,t=h}this.ballonggruppe.setVelocityX(-this.fart),this.ballonggruppe.setVelocityY(-25),this.physics.add.overlap(this.skybilKonteiner,this.ballonggruppe,(r,o)=>{o.disableBody(!0,!0),this.lydeffekter.poeng();const[h,u]=this.finnStorsteXOgTilhorendeYBlantballonger(),[c,y]=this.lagGanskeTilfeldigXY(h,u);o.enableBody(!0,c,y,!0,!0),this.fart+=this.fartsokningPerBallong,this.ballonggruppe.setVelocityX(-this.fart),this.resultat+=1,this.resultattekst.setText(this.hentResultattekst())}),this.resultattekst=this.add.text(15,20,this.hentResultattekst(),{fontFamily:"arial",fontSize:"20px",color:"#000"})}update(){this.ballonggruppe.children.iterate(e=>{e.x<0&&this.tap()}),this.skybilRoykTeller>10&&(this.skybilRoyk.visible=!1,this.skybilRoykTeller=0),this.skybilRoykTeller++}finnStorsteXOgTilhorendeYBlantballonger(){let e=0,s=0;return this.ballonggruppe.children.iterate(l=>{l.x>e&&(e=l.x,s=l.y)}),[e,s]}lagGanskeTilfeldigXY(e,s){const l=e+this.innstillinger.avstandMellomballonger;let t=0;do t=Phaser.Math.Between(50,this.hoyde-50);while(Math.abs(t-s)>this.innstillinger.maksHoydeAvstandMellomToballonger);return[l,t]}fly(){this.lydeffekter.motor(),this.skybilKonteiner.body.setVelocityY(-this.innstillinger.flykraft),this.skybilRoyk.visible=!0,this.skybilRoykTeller=0}tap(){this.lydeffekter.tap(),this.scene.pause(),this.cameras.main.setBackgroundColor(12237498),this.cameras.main.setAlpha(.5),this.forrigeResultat=this.resultat,this.toppresultat=Math.max(this.resultat,this.toppresultat),this.toppresultat>this.toppresultatServer&&(this.toppresultatServer=this.toppresultat),localStorage.setItem(this.innstillinger.nokkelLagring,this.toppresultat.toString()),this.resultattekst.setText(this.hentResultattekst()),this.lagreResultat(this.resultat),this.scene.launch("tapssene",{resultat:this.resultat}),this.resultat=0,this.fart=this.startfart,console.log("Ferdig i tap().")}hentResultattekst(){let e=`Ballonger: ${this.resultat}`;return this.toppresultat>0&&(e+=`
Rekord: ${this.toppresultat}`),this.forrigeResultat>0&&(e+=`
Forrige fors\xF8k: ${this.forrigeResultat}`),e}async lagreResultat(e){if(e===0){console.log("Gidder ikke lagre n\xE5r det ble 0 poeng.");return}const l={Navn:this.spillernavn?this.spillernavn:"Anonym",Antall:e,Logg:`Poeng ${e}`};console.log("Skal sende:",l)}}class v extends Phaser.Scene{constructor(){super({key:"tapssene"});i(this,"bredde");i(this,"hoyde");i(this,"forrigeResultat")}init(e){this.bredde=this.game.scale.gameSize.width,this.hoyde=this.game.scale.gameSize.height,this.forrigeResultat=e.resultat}create(){const e=`Du klarte ${this.forrigeResultat}
Trykk for \xE5 pr\xF8ve igjen`;this.add.text(this.bredde/2,this.hoyde/2,e,{fontFamily:"arial",fontSize:"20px",color:"#000",align:"center",backgroundColor:"#87ceeb",padding:{x:5,y:5}}).setOrigin(.5,.5);const s=setTimeout(()=>{this.scene.setVisible(!1,"skysene"),this.scene.start("velkomstsene")},1e4);setTimeout(()=>{this.input.once("pointerdown",()=>{clearTimeout(s),this.scene.start("skysene")})},500)}}class S extends Phaser.Scene{constructor(){super({key:"velkomstsene"});i(this,"bredde");i(this,"hoyde");i(this,"logoKonteiner");i(this,"spillernavn",localStorage.getItem("spillernavn"));i(this,"toppresultatServer")}init(){const e=this.cameras.main.width,s=this.cameras.main.height;this.bredde=this.game.scale.gameSize.width,this.hoyde=this.game.scale.gameSize.height,console.log("init()",e,s,this.bredde,this.hoyde),this.scene.isActive("volumsene")||(this.scene.launch("volumsene"),this.scene.bringToTop("volumsene"))}preload(){this.load.image("skybil-med-tekst","assets/skybil-med-tekst.png")}create(){console.log("velkomstsene create()");const e=this.add.image(0,0,"skybil-med-tekst").setInteractive().once("pointerdown",()=>this.startNyttSpill()),s=this.bredde*.8;if(e.width>s){const t=s/e.width;e.setScale(t)}const l=this.add.text(0,200,"Trykk p\xE5 skyen for \xE5 starte spillet",{fontFamily:"arial",fontSize:"20px",color:"#000",align:"center"}).setOrigin(.5,.5).setInteractive().once("pointerdown",()=>this.startNyttSpill());this.logoKonteiner=this.add.container(0,0,[e,l]),this.posisjoner()}posisjoner(){const e=this.bredde/2,s=this.hoyde/2-75;this.logoKonteiner.setPosition(e,s)}startNyttSpill(){this.scene.sleep(),this.scene.start("skysene",{spillernavn:this.spillernavn,toppresultatServer:this.toppresultatServer})}}class T extends Phaser.Scene{constructor(){super({key:"volumsene"});i(this,"bredde");i(this,"hoyde");i(this,"volumknapp");i(this,"demp",!1)}init(){this.bredde=this.game.scale.gameSize.width,this.hoyde=this.game.scale.gameSize.height,this.demp=localStorage.getItem("demp")!=="false",this.sound.mute=this.demp}preload(){this.load.spritesheet("volum","assets/volum.png",{frameWidth:50,frameHeight:50})}create(){this.volumknapp=this.add.sprite(0,0,"volum").setScale(.5).setOrigin(0,0).setInteractive(new Phaser.Geom.Rectangle(-100,-100,200,200),Phaser.Geom.Rectangle.Contains).on("pointerdown",()=>this.toggleVolum()),this.settRiktigVolumknapp(),this.posisjoner()}posisjoner(){this.volumknapp.setPosition(this.bredde-45,18)}toggleVolum(){this.demp=!this.demp,this.sound.mute=this.demp,localStorage.setItem("demp",this.demp.toString()),this.settRiktigVolumknapp()}settRiktigVolumknapp(){this.demp?this.volumknapp.setFrame(1):this.volumknapp.setFrame(0)}}let d=!0;d=!1;let R=Date.now(),p;const x=/iPad|iPhone|iPod/.test(navigator.userAgent),[w,P,B,I,F]=K(),g=new a.Game(j(w,P,F,d));window.onresize=()=>{x&&Date.now()-R<1e3||(clearTimeout(p),p=setTimeout(()=>{g&&g.destroy(!0),document.location.reload()},200))};function j(n,e,s,l){return{type:a.AUTO,width:n,height:e,scene:[S,T,b,v],parent:"spillkonteiner",dom:{createContainer:!0},backgroundColor:8900331,autoFocus:!0,pixelArt:!1,physics:{default:"arcade",arcade:{gravity:{y:0},debug:l}},scale:{mode:s,autoCenter:a.Scale.Center.CENTER_BOTH}}}function K(){const n=window.innerWidth,e=window.innerHeight,s=800,l=1024;let t=0,r=a.Scale.ScaleModes.NONE;return e<=l?(console.log("vinduHoyde <= brekkpunktLitenDings. M\xE5 ha FIT."),t=n/e*s,console.log("hoyde og bredde n\xE5r viduH\xF8yde < minsteHoyde",t,s),r=a.Scale.ScaleModes.FIT):t=1024,t>n&&(r=a.Scale.ScaleModes.FIT),console.table({vindu:[n,e],beregnet:[t,s]}),console.log("skaleringsmetode",r),[t,s,n,e,r]}
